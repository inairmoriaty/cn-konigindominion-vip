<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>KÃ–NIGIN - éº¦éº¦&Ghostçš„æˆ¿é—´</title>

  <link rel="stylesheet" href="/style/footer.css">
  <link rel="stylesheet" href="/style/mobile.css">
  <style>
:root{
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --vh: 1vh;
}
@supports (height: 100svh){
  :root{ --vh: 1svh; }
}

    html, body {
      margin: 0; 
      padding: 0;
      width: 100vw;
      height: 100vh;
      background: #191919;
      overflow: hidden;
    }

.app-frame{
  width:100%;
  max-width:1440px;
  min-height: calc(var(--vh) * 100);
  position:relative;
  margin:0 auto;
  box-shadow:none;
  background:#191919;
  border-radius:0;
  overflow:visible;        /* è®©å†…éƒ¨å…ƒç´ èƒ½æ˜¾ç¤º/æ»šåŠ¨ */
  padding-top: var(--safe-top);
  padding-bottom: var(--safe-bottom); /* åº•æ é¢å¤–ç•™ç™½ç”± footer.css ç»Ÿä¸€å¤„ç† */
  box-sizing:border-box;
}

    /* æ¨ªå‘æ»‘åŠ¨èƒŒæ™¯å®¹å™¨ */
    .horizontal-bg-container {
      position: absolute;
      left: 0; 
      top: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 1;
    }

    /* èƒŒæ™¯å›¾ç‰‡å®¹å™¨ - å¯ä»¥å·¦å³æ»‘åŠ¨ */
    .bg-slider {
      position: absolute;
      left: 0; 
      top: 0;
      width: 300%; /* 3å€å®½åº¦ï¼Œå¯¹åº”å›¾ç‰‡çš„3ä¸ªéƒ¨åˆ† */
      height: 100%;
      background-image: url('../../img/guest/filet-o-fish_bg.png');
      background-size: auto 100%; /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹ï¼Œé«˜åº¦100% */
      background-position: left center;
      background-repeat: no-repeat;
      transition: transform 0.3s ease-out;
      cursor: grab;
      will-change: transform; /* ä¼˜åŒ–æ€§èƒ½ */
    }

    .bg-slider:active {
      cursor: grabbing;
    }

    /* æ»‘åŠ¨æŒ‡ç¤ºå™¨ - é•¿æ¡baræ ·å¼ */
    .slide-indicators {
      position: absolute;
      bottom: 120px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 4px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 2px;
      z-index: 10;
      cursor: pointer;
      overflow: hidden;
    }

    .indicator {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.6);
      border-radius: 2px;
      transform: scaleX(0);
      transform-origin: left center;
      transition: transform 0.3s ease;
      pointer-events: none;
    }

    .indicator.active {
      transform: scaleX(1);
    }

    /* æ»‘åŠ¨æç¤º */
    .slide-hint {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: rgba(255, 255, 255, 0.6);
      font-size: 14px;
      font-family: "SimSun", "å®‹ä½“", serif;
      text-align: center;
      z-index: 5;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .slide-hint.show {
      opacity: 1;
    }

    /* å†…å®¹å±‚ */
    .content-layer {
      position: absolute;
      left: 0; 
      top: 0;
      width: 100%;
      height: 100%;
      z-index: 2;
      pointer-events: none;
    }

    .content-layer > * {
      pointer-events: auto;
    }

    /* æ ‡é¢˜ */
    .page-title {
      position: absolute;
      top: 5%;
      left: 50%;
      transform: translateX(-50%);
      width: 300px;
      height: 120px;
      z-index: 2;
      pointer-events: none;
    }

    /* é—¨ç‰Œ */
    .guest-title {
      position: absolute;
      top: -3%; 
      left: 50%;
      transform: translateX(-50%);
      width: 750px; 
      height: 300px;
      background: url('../../img/door\ brand.png') center center/contain no-repeat;
      z-index: 2;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .guest-title.show {
      opacity: 1;
    }

    /* äº¤äº’æŒ‰é’® */
    .interaction-btn {
      position: absolute;
      z-index: 10;
      display: block;
      cursor: pointer;
    }

    .btn-bed {
      top: 68%; /* æ•å¤´çš„ä½ç½®ï¼Œå¤§çº¦65%ä»é¡¶éƒ¨ */
      left: 50%; /* æ•å¤´çš„ä½ç½®ï¼Œç¨å¾®åå·¦ */
      transform: translate(-50%, -50%);
    }

    .btn-whisky {
      top: 65%; /* å¨å£«å¿Œçš„ä½ç½®ï¼Œå¤§çº¦60%ä»é¡¶éƒ¨ */
      left: 65%; /* å¨å£«å¿Œçš„ä½ç½®ï¼Œåœ¨å·¦ä¾§ */
      transform: translate(-50%, -50%);
    }

.interaction-btn img{
  /* 56px åˆ° 100pxï¼Œéšè§†å£ç¼©æ”¾ */
  width: clamp(56px, 12vmin, 100px);
  height: clamp(56px, 12vmin, 100px);
  display:block;
  pointer-events:auto;
  transition: transform .2s ease, filter .2s ease;
}
    .interaction-btn:hover img {
      filter: brightness(1.2);
      transform: scale(1.05);
    }

    .interaction-btn:active img {
      filter: brightness(0.8);
      transform: scale(0.95);
    }

    /* æŒ‰é’®æ˜¾ç¤º/éšè—æ§åˆ¶ */
    .interaction-btn {
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      pointer-events: none;
    }

    .interaction-btn.show {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }

    /* åº•éƒ¨é®ç½© */
.bottom-mask{
  position:absolute; left:0; bottom:0; width:100%;
  height:92px; background:#191919; z-index:3; pointer-events:none;
}
    /* è¾¹ç•Œæç¤ºæ•ˆæœ */
    .boundary-hint {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      z-index: 15;
    }

    .boundary-hint.show {
      opacity: 1;
    }

    .boundary-hint.left {
      left: 20px;
    }

    .boundary-hint.right {
      right: 20px;
    }

    .boundary-hint::before {
      content: '';
      width: 12px;
      height: 12px;
      border: 2px solid rgba(255, 255, 255, 0.6);
      border-top: none;
      border-right: none;
    }

    .boundary-hint.left::before {
      transform: rotate(45deg);
    }

    .boundary-hint.right::before {
      transform: rotate(-135deg);
    }

    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 768px) {
      .slide-indicators {
        bottom: 100px;
        width: 150px;
        height: 3px;
      }
      
      .boundary-hint {
        width: 30px;
        height: 30px;
      }
      
      .boundary-hint::before {
        width: 8px;
        height: 8px;
      }
      
      /* ç§»åŠ¨ç«¯èƒŒæ™¯å›¾ä¼˜åŒ– */
      .bg-slider {
        background-size: auto 100%;
        background-position: left center;
        background-attachment: scroll;
      }
    }

/* å®¢å•æ»šè½®é€‰é¡¹åŒºåŸŸ â€”â€” é»˜è®¤ä¸æ¥æ”¶ç‚¹å‡»ï¼Œæ˜¾ç¤ºæ—¶å†æ‰“å¼€ */
.guest-list-wrapper{
  position: absolute;
  left: 53%;
  transform: translateX(-50%);
  top: 22%;
  width: 180px;

  /* ç»Ÿä¸€å¯è§†é«˜åº¦ä¸º 3 è¡Œ*72 = 216pxï¼ˆè¡Œé«˜ç¨³å®šï¼Œæ‰‹æ„Ÿç±»ä¼¼ iOSï¼‰ */
  height: 216px;

  z-index: 20;
  display: flex;
  align-items: stretch;
  gap: 12px;

  opacity: 0;
  visibility: hidden;
  pointer-events: none;              /* ğŸ‘ˆ éšè—æ—¶ä¸æŠ¢äº‹ä»¶ */
  transition: opacity .3s ease, visibility .3s ease;

  /* æ€§èƒ½ä¼˜åŒ– */
  will-change: opacity, transform;
}
.guest-list-wrapper.show {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;              /* ğŸ‘ˆ æ˜¾ç¤ºæ—¶å¯ç‚¹ */
}

/* å®¹å™¨å†…å±‚ï¼šä¿ç•™æ¸éšè’™ç‰ˆï¼Œè®©ä¸­é—´åŒºåŸŸæ›´èšç„¦ */
.guest-list{
  position: relative;
  flex: 1 1 auto;
  height: 100%;
  overflow: hidden;

  /* ä¸Šä¸‹æ¸éšï¼ˆ36px è¾¹ç¼˜ï¼‰ */
  -webkit-mask-image: linear-gradient(to bottom,
    rgba(0,0,0,0) 0,
    rgba(0,0,0,1) 36px,
    rgba(0,0,0,1) calc(100% - 36px),
    rgba(0,0,0,0) 100%);
  mask-image: linear-gradient(to bottom,
    rgba(0,0,0,0) 0,
    rgba(0,0,0,1) 36px,
    rgba(0,0,0,1) calc(100% - 36px),
    rgba(0,0,0,0) 100%);
}

/* è§†å£ï¼š3 è¡Œå¯è§ï¼ˆ216pxï¼‰ï¼Œå¸é™„æ»šåŠ¨ã€è§¦æ‘¸æ»šåŠ¨å¢å¼º */
.guest-list-viewport{
  height: 216px;                     /* ğŸ‘ˆ å›ºå®š 3 è¡Œå¯è§ */
  overflow-y: auto;
  padding-right: 8px;
  scrollbar-width: none;             /* Firefox éšè—æ»šåŠ¨æ¡ */

  /* è§¦æ‘¸ä¼˜åŒ– */
  -webkit-overflow-scrolling: touch; /* iOS æƒ¯æ€§æ»šåŠ¨ */
  overscroll-behavior: contain;      /* é˜²çˆ¶çº§è”åŠ¨ */
  touch-action: pan-y;               /* å‘Šè¯‰æµè§ˆå™¨è¿™æ˜¯çºµå‘æ»šåŠ¨ */

  /* å¸é™„æ»šåŠ¨ï¼šåœåœ¨â€œè¡Œä¸­å¿ƒâ€é™„è¿‘ */
  scroll-snap-type: y mandatory;
}
.guest-list-viewport::-webkit-scrollbar{ display: none; }

/* å•é¡¹ï¼šè¡Œé«˜ç¨³å®šï¼ˆ72px = 48 + ä¸Šä¸‹å„ 12pxï¼‰ */
.guest-item{
  /* å°½é‡å æ»¡ï¼Œå‘½ä¸­ç‡æ›´é«˜ */
  width: 100%;
  box-sizing: border-box;

  height: 48px;          /* å…ƒç´ æœ¬ä½“é«˜åº¦ */
  padding: 0 10px;
  margin: 12px 0;        /* ä¸Šä¸‹å„ 12pxï¼Œæ€»è¡Œè·=72px */
  display: flex;
  align-items: center;
  justify-content: center;

  color: #fff;
  font-size: 16px;
  font-family: "SimSun","å®‹ä½“",serif;
  letter-spacing: .5px;
  user-select: none;
  cursor: pointer;

  /* è§†è§‰ */
  background: linear-gradient(180deg, #5a5a5a 0%, #4a4a4a 45%, #414141 100%);
  border: 1px solid #696969;
  border-radius: 14px;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.12),
    inset 0 -2px 4px rgba(0,0,0,.35),
    0 2px 10px rgba(0,0,0,.25);
  transition: transform .15s ease, background .2s ease;

  /* å¸é™„å¯¹é½åˆ°å®¹å™¨ä¸­å¿ƒçº¿ */
  scroll-snap-align: center;

  /* ç§»åŠ¨ç«¯ä½“éªŒ */
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  will-change: transform;
}
.guest-item:hover {
  background: linear-gradient(180deg, #6a6a6a 0%, #5a5a5a 45%, #515151 100%);
  transform: scale(1.02);
}
.guest-item:active {
  transform: scale(0.98);
}    

    .interaction-btn:active img {
  /* å¯é€‰ï¼šæŒ‰ä¸‹å˜æš—æˆ–ç¼©æ”¾ */
  filter: brightness(0.8);
  transform: scale(0.92);
}
@keyframes btn-blink {
  0%   { opacity: 1; filter: drop-shadow(0 0 0px #fff6) brightness(1); }
  40%  { opacity: 0.6; filter: drop-shadow(0 0 8px #e6f3ff) brightness(1.3);}
  60%  { opacity: 1; filter: drop-shadow(0 0 16px #b5e2ff) brightness(1.5);}
  100% { opacity: 1; filter: drop-shadow(0 0 0px #fff6) brightness(1); }
}
.interaction-btn.blink img {
  animation: btn-blink 1.2s infinite;
  /* å¯é€‰ï¼šåŠ¨ç”»èŠ‚å¥å¹³æ»‘ */
  animation-timing-function: ease-in-out;
}
  </style>
</head>
<body>
  <div class="app-frame">
    <div class="bg-slider"></div>
    <div class="guest-title"></div>
    
      <!-- åºŠä¸Šçš„äº¤äº’æŒ‰é’® -->
      <a href="#" class="interaction-btn btn-bed blink" title="Bed Interaction" id="bedButton">
        <img src="../../img/default btn.png" alt="Bed Button"/>
      </a>
      
      <!-- æ¡Œå­ä¸Šçš„äº¤äº’æŒ‰é’® -->
      <a href="#" class="interaction-btn btn-whisky blink" title="Whisky Interaction" id="whiskyButton">
        <img src="../../img/default btn.png" alt="Whisky Button"/>
      </a>
    
    <!-- å®¢å•æ»šè½®é€‰é¡¹ï¼ˆé»˜è®¤éšè—ï¼‰ -->
    <div class="guest-list-wrapper" id="guestList">
      <div class="guest-list">
        <div class="guest-list-viewport" id="guestViewport">
          <div class="guest-item" data-article="vampire.html">å¸è¡€æƒŠæƒ…å››ç™¾å¹´</div>
          <div class="guest-item" data-article="cage.html">æ¬¡å…ƒè£‚ç¼</div>
        </div>
      </div>
      </div>
    </div>
    
    <div class="bottom-mask"></div>
  </div>

  <!-- Footerè‡ªåŠ¨æ’å…¥ç‚¹ -->
  <div id="footer-placeholder"></div>
  <script src="../../js/mobile-optimization.js"></script>
  <script src="../../js/footer.js"></script>
<script>
// é¡µé¢åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
  console.log('Filet page loaded');
  
  // æ£€æŸ¥footeræ˜¯å¦åŠ è½½
  setTimeout(() => {
    const footer = document.querySelector('.bottom-nav');
    if (footer) {
      console.log('Footer loaded successfully');
    } else {
      console.log('Footer not found, checking placeholder');
      const placeholder = document.getElementById('footer-placeholder');
      console.log('Footer placeholder:', placeholder);
    }
  }, 1000);
  
  // åºŠæŒ‰é’®ç‚¹å‡»äº‹ä»¶
  const bedButton = document.getElementById('bedButton');
  const guestList = document.getElementById('guestList');
  let isGuestListVisible = false;
  
  if (bedButton) {
    console.log('Bed button found, using pointer event');
    // åŒæ—¶æ”¯æŒç‚¹å‡»å’Œè§¦æ‘¸
    const handleBedClick = function(e) {
      e.preventDefault();
      e.stopPropagation();
      console.log('Bed button clicked/touched');
      
      // åˆ‡æ¢æ»šè½®é€‰é¡¹çš„æ˜¾ç¤º/éšè—
      if (isGuestListVisible) {
        guestList.classList.remove('show');
        isGuestListVisible = false;
        console.log('Guest list hidden');
      } else {
        guestList.classList.add('show');
        isGuestListVisible = true;
        console.log('Guest list shown');
      }
    };
    
    // ç¡®ä¿æŒ‰é’®å¯ä»¥æ¥æ”¶äº‹ä»¶
    bedButton.style.pointerEvents = 'auto';
    bedButton.style.zIndex = '20'; // ç¡®ä¿æŒ‰é’®åœ¨æœ€ä¸Šå±‚
    
    bedButton.addEventListener('click', handleBedClick);
    bedButton.addEventListener('touchend', handleBedClick);
    console.log('Bed button event listeners added');
  } else {
    console.error('Bed button not found');
  }
  
  // ä¿å­˜articleå±‚çº§ä¼šè¯çš„å‡½æ•°
  function saveArticleHierarchySession() {
    const session = {
      timestamp: Date.now(),
      expiry: Date.now() + (30 * 60 * 1000) // 30åˆ†é’Ÿè¿‡æœŸ
    };
    sessionStorage.setItem('article_hierarchy_session', JSON.stringify(session));
    console.log('Articleå±‚çº§ä¼šè¯å·²ä¿å­˜');
  }

  // WhiskyæŒ‰é’®ç‚¹å‡»äº‹ä»¶
  const whiskyButton = document.getElementById('whiskyButton');
  if (whiskyButton) {
    console.log('Whisky button found, adding event listeners');
    const handleWhiskyClick = function(e) {
      e.preventDefault();
      e.stopPropagation();
      console.log('Whisky button clicked/touched');
      
      // ä¿å­˜articleå±‚çº§ä¼šè¯åè·³è½¬
      saveArticleHierarchySession();
      window.location.href = '../../article/private/2049.html';
    };
    
    whiskyButton.addEventListener('click', handleWhiskyClick);
    whiskyButton.addEventListener('touchend', handleWhiskyClick);
    console.log('Whisky button event listeners added');
  } else {
    console.error('Whisky button not found');
  }
  
  // è‡ªå®šä¹‰æ»šåŠ¨æ¡ä¸æ»šè½®åŒæ­¥
  const viewport = document.getElementById('guestViewport');
  const thumb = document.getElementById('guestThumb');
  const scrollbar = document.getElementById('guestScrollbar');
  
  if(viewport && thumb && scrollbar) {
    function updateThumb(){
      const viewH = viewport.clientHeight;
      const scrollH = viewport.scrollHeight;
      const trackH = scrollbar.clientHeight;
      const minThumb = 24;
      const thumbH = Math.max(minThumb, Math.round(viewH * viewH / Math.max(scrollH, 1)));
      const maxTop = Math.max(trackH - thumbH, 0);
      const top = (viewport.scrollTop / Math.max(scrollH - viewH, 1)) * maxTop;
      thumb.style.height = thumbH + 'px';
      thumb.style.top = top + 'px';
    }

    // ç›‘å¬æ»šåŠ¨å’Œå°ºå¯¸å˜åŒ–
    viewport.addEventListener('scroll', updateThumb, { passive: true });
    window.addEventListener('resize', updateThumb);
    // åˆå§‹åŒ–
    updateThumb();
  }
  
  // æ»šè½®é€‰é¡¹ç‚¹å‡»è·³è½¬
  const guestItems = document.querySelectorAll('.guest-item');
  guestItems.forEach(item => {
    const handleGuestItemClick = function() {
      const articleFile = this.getAttribute('data-article');
      if (articleFile) {
        console.log('Jumping to article:', articleFile);
        
        // ä¿å­˜articleå±‚çº§ä¼šè¯
        saveArticleHierarchySession();
        
        if (articleFile === 'vampire.html') {
          window.location.href = `../../article/private/vampire.html`;
        } else if (articleFile === 'cage.html') {
          window.location.href = `../../article/private/cage.html`;
        } else {
          window.location.href = `../../article/private/${articleFile}`;
        }
      }
    };
    
    item.addEventListener('click', handleGuestItemClick);
    item.addEventListener('touchend', handleGuestItemClick);
  });

  // èƒŒæ™¯æ»‘åŠ¨åŠŸèƒ½ - è¿ç»­æ»‘åŠ¨ç‰ˆæœ¬
  const bgSlider = document.querySelector('.bg-slider');
  const slideIndicators = document.querySelector('.slide-indicators');
  const slideHint = document.querySelector('.slide-hint');
  
  if (bgSlider) {
    let currentPosition = 0; // å½“å‰ä½ç½®ï¼ˆç™¾åˆ†æ¯”ï¼‰
    let isDragging = false;
    let startX = 0;
    let currentX = 0;
    let startPosition = 0; // å¼€å§‹æ‹–åŠ¨æ—¶çš„ä½ç½®
    let maxSlideDistance = 100; // æœ€å¤§æ»‘åŠ¨è·ç¦»ï¼Œè®¾ç½®é»˜è®¤å€¼
    let touchStartTime = 0; // è§¦æ‘¸å¼€å§‹æ—¶é—´

    // åˆå§‹åŒ–
    function initSlider() {
      console.log('=== åˆå§‹åŒ–æ»‘åŠ¨åŠŸèƒ½ ===');
      console.log('bgSliderå…ƒç´ :', bgSlider);
      console.log('å½“å‰maxSlideDistance:', maxSlideDistance);
      console.log('å½“å‰currentPosition:', currentPosition);
      
      // åŠ¨æ€è®¡ç®—æœ€å¤§æ»‘åŠ¨è·ç¦»
      calculateMaxSlideDistance();
      
      updateSlider();
      showHint();
      
      // æµ‹è¯•æ»‘åŠ¨åŠŸèƒ½
      setTimeout(() => {
        console.log('=== æ»‘åŠ¨åŠŸèƒ½æµ‹è¯• ===');
        console.log('æœ€ç»ˆmaxSlideDistance:', maxSlideDistance);
        console.log('æœ€ç»ˆcurrentPosition:', currentPosition);
        console.log('bgSlider transform:', bgSlider.style.transform);
        
        // æµ‹è¯•æ»‘åŠ¨åˆ°ä¸åŒä½ç½®
        if (maxSlideDistance > 0) {
          console.log('æ»‘åŠ¨åŠŸèƒ½å·²å‡†å¤‡å°±ç»ª');
        } else {
          console.error('æ»‘åŠ¨åŠŸèƒ½åˆå§‹åŒ–å¤±è´¥');
        }
        

      }, 1000);
    }

    // è®¡ç®—æœ€å¤§æ»‘åŠ¨è·ç¦»
    function calculateMaxSlideDistance() {
      console.log('å¼€å§‹è®¡ç®—æœ€å¤§æ»‘åŠ¨è·ç¦»...');
      const img = new Image();
      img.onload = function() {
        console.log('èƒŒæ™¯å›¾ç‰‡åŠ è½½æˆåŠŸ');
        const containerWidth = window.innerWidth;
        const imgWidth = this.width;
        const imgHeight = this.height;
        
        console.log('å›¾ç‰‡å°ºå¯¸:', imgWidth, 'x', imgHeight);
        console.log('å®¹å™¨å°ºå¯¸:', containerWidth, 'x', window.innerHeight);
        
        // è®¡ç®—å›¾ç‰‡åœ¨å®¹å™¨ä¸­çš„å®é™…æ˜¾ç¤ºå®½åº¦
        const containerHeight = window.innerHeight;
        const scale = containerHeight / imgHeight;
        const displayWidth = imgWidth * scale;
        
        // è®¡ç®—å¯ä»¥æ»‘åŠ¨çš„è·ç¦»
        if (displayWidth > containerWidth) {
          const actualSlideDistance = displayWidth - containerWidth;
          maxSlideDistance = (actualSlideDistance / containerWidth) * 100 * 0.30; // ç¼©å°åˆ°30% é€‚é…èƒŒæ™¯å›¾å®½åº¦
        } else {
          maxSlideDistance = 50; // è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼
        }
        
        console.log('Container width:', containerWidth);
        console.log('Image display width:', displayWidth);
        console.log('Max slide distance:', maxSlideDistance);
        
        // è®¾ç½®åˆå§‹ä½ç½®åˆ°åºŠæŒ‰é’®å¯è§çš„åŒºåŸŸï¼ˆçº¦20%çš„æ»‘åŠ¨è·ç¦»ï¼‰
        currentPosition = -(maxSlideDistance * 0.2);
        console.log('è®¾ç½®åˆå§‹ä½ç½®:', currentPosition);
        
        updateSlider();
      };
      
      // æ·»åŠ é”™è¯¯å¤„ç†
      img.onerror = function() {
        console.error('Failed to load image: ../../img/guest/filet-o-fish_bg.png');
        maxSlideDistance = 200; // è®¾ç½®é»˜è®¤æ»‘åŠ¨è·ç¦»ï¼Œä¸CSS 300%å®½åº¦åŒ¹é…
        // è®¾ç½®åˆå§‹ä½ç½®åˆ°åºŠæŒ‰é’®å¯è§çš„åŒºåŸŸ
        currentPosition = -(maxSlideDistance * 0.2);
        console.log('å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤è®¾ç½®:', maxSlideDistance, currentPosition);
        updateSlider();
      };
      
      console.log('å¼€å§‹åŠ è½½å›¾ç‰‡: ../../img/guest/filet-o-fish_bg.png');
      img.src = '../../img/guest/filet-o-fish_bg.png';
    }

    // æ›´æ–°æ»‘å—ä½ç½®
    function updateSlider() {
      // é™åˆ¶æ»‘åŠ¨èŒƒå›´åœ¨0åˆ°-maxSlideDistanceä¹‹é—´
      currentPosition = Math.max(-maxSlideDistance, Math.min(0, currentPosition));
      bgSlider.style.transform = `translateX(${currentPosition}%)`;
      
      // æ›´æ–°æŒ‡ç¤ºå™¨ä½ç½®
      updateIndicators();
      
      // æ›´æ–°æŒ‰é’®æ˜¾ç¤ºçŠ¶æ€
      updateButtonVisibility();
      
      // æ›´æ–°é—¨ç‰Œæ˜¾ç¤ºçŠ¶æ€
      updateTitleVisibility();
    }

    // æ›´æ–°æŒ‰é’®æ˜¾ç¤ºçŠ¶æ€
    function updateButtonVisibility() {
      const bedButton = document.getElementById('bedButton');
      const whiskyButton = document.getElementById('whiskyButton');
      
      // è®¡ç®—å½“å‰ä½ç½®çš„ç™¾åˆ†æ¯”
      const progress = Math.abs(currentPosition) / maxSlideDistance;
      
      console.log('Filet button visibility check - progress:', progress, 'currentPosition:', currentPosition, 'maxSlideDistance:', maxSlideDistance);
      
      // æ•å¤´ä½ç½®å¤§çº¦åœ¨æ»‘åŠ¨è¿›åº¦çš„ä¸­é—´ä½ç½®
      // å½“æ•å¤´åœ¨ç”»é¢å†…æ—¶æ˜¾ç¤ºåºŠæŒ‰é’®
      if (bedButton) {
        if (progress >= 0 && progress <= 0.3) {
          bedButton.classList.add('show');
          console.log('Bed button shown');
        } else {
          bedButton.classList.remove('show');
          console.log('Bed button hidden');
        }
      } else {
        console.warn('Bed button not found');
      }
      
      // å¨å£«å¿Œä½ç½®å¤§çº¦åœ¨æ»‘åŠ¨è¿›åº¦çš„å³ä¾§
      // å½“å¨å£«å¿Œåœ¨ç”»é¢å†…æ—¶æ˜¾ç¤ºå¨å£«å¿ŒæŒ‰é’®
      if (whiskyButton) {
        if (progress >= 0.9 && progress <= 1) {
          whiskyButton.classList.add('show');
          console.log('Whisky button shown');
        } else {
          whiskyButton.classList.remove('show');
          console.log('Whisky button hidden');
        }
      } else {
        console.warn('Whisky button not found');
      }
    }

      // ç‚¹å‡»ç©ºç™½åŒºåŸŸéšè—æ»šè½®é€‰é¡¹
  document.addEventListener('click', function(e) {
    // å¦‚æœæ»šè½®é€‰é¡¹æ˜¯æ˜¾ç¤ºçš„ï¼Œä¸”ç‚¹å‡»çš„ä¸æ˜¯åºŠæŒ‰é’®æˆ–æ»šè½®é€‰é¡¹å†…éƒ¨
    if (isGuestListVisible && guestList) {
      const isClickOnBedBtn = bedButton && bedButton.contains(e.target);
      const isClickOnGuestList = guestList.contains(e.target);
      
      if (!isClickOnBedBtn && !isClickOnGuestList) {
        guestList.classList.remove('show');
        isGuestListVisible = false;
      }
    }
  });

  // è§¦æ‘¸äº‹ä»¶ä¹Ÿå¤„ç†ç©ºç™½åŒºåŸŸç‚¹å‡»
  document.addEventListener('touchend', function(e) {
    if (isGuestListVisible && guestList) {
      const isClickOnBedBtn = bedButton && bedButton.contains(e.target);
      const isClickOnGuestList = guestList.contains(e.target);
      
      if (!isClickOnBedBtn && !isClickOnGuestList) {
        guestList.classList.remove('show');
        isGuestListVisible = false;
      }
    }
  });


    // æ›´æ–°é—¨ç‰Œæ˜¾ç¤ºçŠ¶æ€
    function updateTitleVisibility() {
      const titleElement = document.querySelector('.inair-title');
      if (!titleElement) return;
      
      // è®¡ç®—å½“å‰ä½ç½®çš„ç™¾åˆ†æ¯”
      const progress = Math.abs(currentPosition) / maxSlideDistance;
      
      // é—¨ç‰Œåªåœ¨èƒŒæ™¯å›¾æ­£ä¸Šæ–¹æ˜¾ç¤ºï¼Œæ»‘åŠ¨åˆ°ä¸¤ä¾§æ—¶éšè—
      if (progress >= 0.1 && progress <= 0.7) {
        titleElement.classList.add('show');
      } else {
        titleElement.classList.remove('show');
      }
    }

    // æ›´æ–°æŒ‡ç¤ºå™¨
    function updateIndicators() {
      const indicators = document.querySelectorAll('.indicator');
      if (indicators.length === 0) {
        createIndicators();
        return;
      }
      
      if (maxSlideDistance <= 0) {
        // å¦‚æœä¸éœ€è¦æ»‘åŠ¨ï¼Œè¿›åº¦æ¡ä¸º0
        indicators.forEach((indicator) => {
          indicator.style.transform = 'scaleX(0)';
        });
        return;
      }
      
      const progress = Math.abs(currentPosition) / maxSlideDistance;
      // å°†è¿›åº¦è½¬æ¢ä¸º0-1ä¹‹é—´çš„å€¼
      const progressValue = Math.min(1, Math.max(0, progress));
      
      indicators.forEach((indicator) => {
        indicator.style.transform = `scaleX(${progressValue})`;
      });
    }

    // åˆ›å»ºæ»‘åŠ¨æŒ‡ç¤ºå™¨
    function createIndicators() {
      if (!slideIndicators) {
        const appFrame = document.querySelector('.app-frame');
        if (!appFrame) {
          console.error('app-frame element not found');
          return;
        }
        
        const indicators = document.createElement('div');
        indicators.className = 'slide-indicators';
        
        // åˆ›å»ºè¿›åº¦æ¡æŒ‡ç¤ºå™¨
        const indicator = document.createElement('div');
        indicator.className = 'indicator';
        indicators.appendChild(indicator);
        
        // æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç‚¹å‡»è¿›åº¦æ¡å¯ä»¥è·³è½¬åˆ°å¯¹åº”ä½ç½®
        indicators.addEventListener('click', function(e) {
          const rect = this.getBoundingClientRect();
          const clickX = e.clientX - rect.left;
          const progress = clickX / rect.width;
          goToPosition(progress * 100);
        });
        
        // æ·»åŠ è§¦æ‘¸äº‹ä»¶
        indicators.addEventListener('touchend', function(e) {
          const rect = this.getBoundingClientRect();
          const touch = e.changedTouches[0];
          const clickX = touch.clientX - rect.left;
          const progress = clickX / rect.width;
          goToPosition(progress * 100);
        });
        
        appFrame.appendChild(indicators);
        console.log('Indicators created and added');
      }
    }

    // åˆ›å»ºæ»‘åŠ¨æç¤º
    function createSlideHint() {
      if (!slideHint) {
        const appFrame = document.querySelector('.app-frame');
        if (!appFrame) {
          console.error('app-frame element not found');
          return;
        }
        
        const hint = document.createElement('div');
        hint.className = 'slide-hint';
        hint.textContent = 'å·¦å³æ»‘åŠ¨æŸ¥çœ‹å…¨æ™¯';
        appFrame.appendChild(hint);
        console.log('Slide hint created and added');
      }
    }

    // æ˜¾ç¤ºæç¤º
    function showHint() {
      const hint = document.querySelector('.slide-hint');
      if (hint) {
        hint.classList.add('show');
        setTimeout(() => {
          hint.classList.remove('show');
        }, 3000);
      }
    }

    // åˆ‡æ¢åˆ°æŒ‡å®šä½ç½®
    function goToPosition(percentage) {
      currentPosition = -percentage * maxSlideDistance / 100;
      updateSlider();
    }

    // é¼ æ ‡äº‹ä»¶
    bgSlider.addEventListener('mousedown', function(e) {
      console.log('é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶è§¦å‘');
      // å¦‚æœguest listæ˜¾ç¤ºï¼Œåˆ™ä¸å¤„ç†èƒŒæ™¯æ»‘åŠ¨
      if (isGuestListVisible) {
        console.log('Guest listæ˜¾ç¤ºä¸­ï¼Œå¿½ç•¥æ»‘åŠ¨');
        return;
      }
      
      isDragging = true;
      startX = e.clientX;
      currentX = startX;
      startPosition = currentPosition; // è®°å½•å¼€å§‹æ‹–åŠ¨æ—¶çš„ä½ç½®
      bgSlider.style.cursor = 'grabbing';
      bgSlider.style.transition = 'none';
      console.log('å¼€å§‹æ‹–åŠ¨ï¼Œèµ·å§‹ä½ç½®:', startPosition, 'èµ·å§‹X:', startX);
    });

    document.addEventListener('mousemove', function(e) {
      if (!isDragging || isGuestListVisible) return;
      
      currentX = e.clientX;
      const diff = currentX - startX;
      
      // ç¡®ä¿maxSlideDistanceæœ‰å€¼
      if (maxSlideDistance <= 0) {
        maxSlideDistance = 200; // è®¾ç½®é»˜è®¤å€¼ï¼Œä¸CSS 300%å®½åº¦åŒ¹é…
        console.log('maxSlideDistanceä¸º0ï¼Œä½¿ç”¨é»˜è®¤å€¼200');
      }
      
      // è®¡ç®—ç›®æ ‡ä½ç½®ï¼ˆåŸºäºå¼€å§‹æ‹–åŠ¨æ—¶çš„ä½ç½®ï¼‰
      let targetPosition = startPosition - (diff / window.innerWidth) * maxSlideDistance;
      
      // æ·»åŠ è¾¹ç•Œé™åˆ¶å’Œé˜»åŠ›æ•ˆæœ
      if (targetPosition > 0) {
        // å‘å³æ»‘åŠ¨è¶…å‡ºå·¦è¾¹ç•Œï¼Œæ·»åŠ é˜»åŠ›
        targetPosition = targetPosition * 0.3;
      } else if (targetPosition < -maxSlideDistance) {
        // å‘å·¦æ»‘åŠ¨è¶…å‡ºå³è¾¹ç•Œï¼Œæ·»åŠ é˜»åŠ›
        const overDistance = Math.abs(targetPosition + maxSlideDistance);
        targetPosition = -maxSlideDistance - (overDistance * 0.3);
      }
      
      currentPosition = targetPosition;
      bgSlider.style.transform = `translateX(${currentPosition}%)`;
      console.log('æ»‘åŠ¨ä¸­ - å½“å‰ä½ç½®:', currentPosition, 'ç›®æ ‡ä½ç½®:', targetPosition, 'å·®å€¼:', diff);
    });

    document.addEventListener('mouseup', function() {
      if (!isDragging || isGuestListVisible) return;
      
      isDragging = false;
      bgSlider.style.cursor = 'grab';
      bgSlider.style.transition = 'transform 0.3s ease-out';
      
      // ç¡®ä¿æœ€ç»ˆä½ç½®åœ¨æœ‰æ•ˆèŒƒå›´å†…
      currentPosition = Math.max(-maxSlideDistance, Math.min(0, currentPosition));
      updateSlider();
    });

    // è§¦æ‘¸äº‹ä»¶ï¼ˆç§»åŠ¨ç«¯ï¼‰- ä¼˜åŒ–ç‰ˆæœ¬
    bgSlider.addEventListener('touchstart', function(e) {
      console.log('è§¦æ‘¸å¼€å§‹äº‹ä»¶è§¦å‘');
      // å¦‚æœguest listæ˜¾ç¤ºï¼Œåˆ™ä¸å¤„ç†èƒŒæ™¯æ»‘åŠ¨
      if (isGuestListVisible) {
        console.log('Guest listæ˜¾ç¤ºä¸­ï¼Œå¿½ç•¥è§¦æ‘¸æ»‘åŠ¨');
        return;
      }
      
      // é˜²æ­¢é»˜è®¤è¡Œä¸º
      e.preventDefault();
      
      isDragging = true;
      touchStartTime = Date.now();
      startX = e.touches[0].clientX;
      currentX = startX;
      startPosition = currentPosition; // è®°å½•å¼€å§‹æ‹–åŠ¨æ—¶çš„ä½ç½®
      bgSlider.style.transition = 'none';
      console.log('å¼€å§‹è§¦æ‘¸æ‹–åŠ¨ï¼Œèµ·å§‹ä½ç½®:', startPosition, 'èµ·å§‹X:', startX);
    }, { passive: false });

    document.addEventListener('touchmove', function(e) {
      if (!isDragging || isGuestListVisible) return;
      
      // é˜²æ­¢é»˜è®¤è¡Œä¸º
      e.preventDefault();
      
      currentX = e.touches[0].clientX;
      const diff = currentX - startX;
      
      // ç¡®ä¿maxSlideDistanceæœ‰å€¼
      if (maxSlideDistance <= 0) {
        maxSlideDistance = 200; // è®¾ç½®é»˜è®¤å€¼ï¼Œä¸CSS 300%å®½åº¦åŒ¹é…
      }
      
      // è®¡ç®—ç›®æ ‡ä½ç½®ï¼ˆåŸºäºå¼€å§‹æ‹–åŠ¨æ—¶çš„ä½ç½®ï¼‰
      let targetPosition = startPosition - (diff / window.innerWidth) * maxSlideDistance;
      
      // æ·»åŠ è¾¹ç•Œé™åˆ¶å’Œé˜»åŠ›æ•ˆæœ
      if (targetPosition > 0) {
        // å‘å³æ»‘åŠ¨è¶…å‡ºå·¦è¾¹ç•Œï¼Œæ·»åŠ é˜»åŠ›
        targetPosition = targetPosition * 0.3;
      } else if (targetPosition < -maxSlideDistance) {
        // å‘å·¦æ»‘åŠ¨è¶…å‡ºå³è¾¹ç•Œï¼Œæ·»åŠ é˜»åŠ›
        const overDistance = Math.abs(targetPosition + maxSlideDistance);
        targetPosition = -maxSlideDistance - (overDistance * 0.3);
      }
      
      currentPosition = targetPosition;
      bgSlider.style.transform = `translateX(${currentPosition}%)`;
    }, { passive: false });

    document.addEventListener('touchend', function(e) {
      if (!isDragging || isGuestListVisible) return;
      
      isDragging = false;
      bgSlider.style.transition = 'transform 0.3s ease-out';
      
      // æ£€æŸ¥æ˜¯å¦ä¸ºå¿«é€Ÿç‚¹å‡»ï¼ˆå°äº200msï¼‰
      const touchDuration = Date.now() - touchStartTime;
      if (touchDuration < 200) {
        // å¿«é€Ÿç‚¹å‡»ï¼Œå¯èƒ½æ˜¯è¯¯è§¦ï¼Œä¸æ›´æ–°ä½ç½®
        console.log('å¿«é€Ÿç‚¹å‡»ï¼Œå¿½ç•¥');
        return;
      }
      
      // ç¡®ä¿æœ€ç»ˆä½ç½®åœ¨æœ‰æ•ˆèŒƒå›´å†…
      currentPosition = Math.max(-maxSlideDistance, Math.min(0, currentPosition));
      updateSlider();
    });

    // é˜²æ­¢æ‹–æ‹½æ—¶é€‰ä¸­æ–‡æœ¬
    bgSlider.addEventListener('selectstart', (e) => e.preventDefault());
    
    // åˆå§‹åŒ–
    createIndicators();
    createSlideHint();
    initSlider();
  }

  // åˆå§‹åŒ–æ»‘åŠ¨åŠŸèƒ½
  console.log('=== Page Elements Check ===');
  console.log('bgSlider:', bgSlider ? 'Found' : 'Not found');
  console.log('slideIndicators:', slideIndicators ? 'Found' : 'Not found');
  console.log('slideHint:', slideHint ? 'Found' : 'Not found');
  console.log('bedButton:', bedButton ? 'Found' : 'Not found');
  console.log('whiskyButton:', whiskyButton ? 'Found' : 'Not found');
  console.log('guestList:', guestList ? 'Found' : 'Not found');
  console.log('guestItems count:', guestItems.length);
  console.log('========================');
  
  // å»¶è¿Ÿåˆå§‹åŒ–ï¼Œç¡®ä¿æ‰€æœ‰å…ƒç´ éƒ½æ­£ç¡®åŠ è½½
  setTimeout(() => {
    if (bgSlider) {
      console.log('Delayed initialization starting...');
      initSlider();
    } else {
      console.error('bgSlider not found for delayed initialization');
    }
  }, 200);
});
</script>
</body>
</html>
