<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KÃ–NIGIN - Ghost å…¬å¼€ç¯‡ç›®</title>
  <link rel="stylesheet" href="../../style/home.css">
  <link rel="stylesheet" href="../../style/footer.css">
  <link rel="stylesheet" href="../../style/mobile.css">
  <style>
/* Redesigned color scheme using red-black-gold tones */

:root {
  --bg-deep: #19171b;
  --bg-dark: #2b0307;
  --gold-plain: #ae7f62;
  --gold-light: #fccdac;
  --red-main: #75020f;
  --red-dark: #51080d;
  --black-pure: #080808;
  --gray-muted: #625f5d;
  --font-base: 'Arial', sans-serif;
}

body {
  font-family: var(--font-base);
  background: linear-gradient(180deg, var(--bg-deep) 0%, var(--bg-dark) 100%);
  color: var(--gold-light);
  margin: 0;
  padding: 0;
  overflow: hidden;
}

.ghost-container {
  position: relative;  /* ä¸ºåº•éƒ¨é®ç½©æä¾›å®šä½å‚è€ƒ */
  width: 100%;
  height: 100vh;
  padding: 20px;
  padding-top: 80px;
  padding-bottom: calc(clamp(56px, 9vh, 72px) + var(--safe-bottom) + 20px);
  overflow-y: auto;
  scroll-behavior: smooth;
  -ms-overflow-style: none;
  scrollbar-width: none;
  box-sizing: border-box;
}

.ghost-container::-webkit-scrollbar {
  display: none;
}

 .header-section {
   text-align: center;
   margin-bottom: 40px;
   padding: 40px 20px;
   background: transparent;
   border-radius: 0;
   box-shadow: none;
   border: none;
 }

.header-title {
  font-size: 48px;
  font-weight: bold;
  margin-bottom: 20px;
  color: var(--gold-plain);
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.header-subtitle {
  font-size: 20px;
  color: var(--gray-muted);
  opacity: 0.85;
}

 .works-grid {
   display: grid;
   grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
   gap: 40px;
   row-gap: 40px;
   column-gap: 40px;
   max-width: 1200px;
   margin: 0 auto;
   padding: 20px 0;
 }

 .work-card {
   background: rgba(255, 255, 255, 0.02);
   border-radius: 0;
   padding: 30px;
   margin: 20px 0;
   box-shadow: 0 2px 15px rgba(0, 0, 0, 0.2);
   border: 1px solid rgba(255, 255, 255, 0.08);
   transition: all 0.3s ease;
   cursor: pointer;
   position: relative;
   overflow: hidden;
   /* è§¦æ‘¸ä¼˜åŒ– */
   -webkit-tap-highlight-color: transparent;
   touch-action: manipulation;
 }



 .work-header {
   margin-bottom: 20px;
 }

 .work-author {
   font-size: 16px;
   color: var(--gray-muted);
   margin-bottom: 15px;
 }

 .work-meta {
   display: flex;
   flex-wrap: wrap;
   gap: 10px;
   margin-bottom: 20px;
 }

 .rating-badge {
   padding: 4px 12px;
   border-radius: 20px;
   font-size: 12px;
   font-weight: bold;
   text-transform: uppercase;
 }

 .rating-mature {
   background: var(--gold-plain);
   color: var(--bg-deep);
 }

 .rating-teen {
   background: var(--gold-light);
   color: var(--bg-deep);
 }

 .rating-18+ {
   background: #75020f;
   color: white;
 }

 .status-badge {
   padding: 4px 12px;
   border-radius: 20px;
   font-size: 12px;
   font-weight: bold;
 }

 .status-progress {
   background: var(--gold-plain);
   color: var(--bg-deep);
 }

 .status-planned {
   background: var(--gray-muted);
   color: white;
 }

 .work-summary {
   font-size: 16px;
   color: var(--gray-muted);
   margin-bottom: 20px;
   font-style: italic;
   line-height: 1.5;
 }

 .work-description {
   font-size: 14px;
   color: var(--gray-muted);
   margin-bottom: 20px;
   padding: 15px;
   background: rgba(255, 255, 255, 0.02);
   border-radius: 8px;
   border-left: 3px solid var(--red-main);
 }

 .tags-section {
   margin-bottom: 20px;
 }

 .section-title {
   font-size: 14px;
   font-weight: bold;
   color: var(--gold-plain);
   margin-bottom: 10px;
   text-transform: uppercase;
 }

 .tags-list {
   display: flex;
   flex-wrap: wrap;
   gap: 6px;
 }

 .tag {
   padding: 4px 8px;
   background: rgba(182, 157, 157, 0.05);
   border: 1px solid rgba(255, 255, 255, 0.1);
   border-radius: 12px;
   font-size: 12px;
   color: var(--gold-light);
 }

 .warning-tag {
   background: rgba(255, 0, 0, 0.1);
   border-color: rgba(255, 0, 0, 0.2);
   color: white;
 }

 .work-footer {
   display: flex;
   justify-content: space-between;
   align-items: center;
   margin-top: 20px;
   padding-top: 20px;
   border-top: 1px solid rgba(255, 255, 255, 0.1);
 }

 .work-meta-info {
   font-size: 12px;
   color: var(--gray-muted);
 }





.work-title {
  font-size: 28px;
  font-weight: bold;
  color: var(--gold-light);
}

.work-summary,
.work-description {
  color: white;
}

.rating-explicit {
  background: var(--red-main);
  color: white;
}

.status-completed {
  background: var(--gold-plain);
  color: var(--bg-deep);
}

 .read-button {
   background: linear-gradient(45deg, var(--red-main), var(--red-dark));
   color: white;
   border: none;
   padding: 5px 15px;
   font-size: 12px;
   font-weight: bold;
   border-radius: 0;
   cursor: pointer;
   text-decoration: none;
   display: inline-flex;
   align-items: center;
   justify-content: center;
   line-height: 1;
   /* è§¦æ‘¸ä¼˜åŒ– */
   -webkit-tap-highlight-color: transparent;
   touch-action: manipulation;
   transition: all 0.3s ease;
 }



 .read-button:active {
   transform: translateY(0);
   box-shadow: 0 2px 8px rgba(255, 0, 0, 0.1);
 }

.read-button:hover {
  box-shadow: 0 4px 15px rgba(255, 0, 0, 0.2);
  transform: translateY(-2px);
}



 /* è§¦æ‘¸åé¦ˆæ ·å¼ */
 .touch-active {
   transform: scale(0.95) !important;
   transition: transform 0.1s ease !important;
 }

 .loading {
   text-align: center;
   padding: 40px;
   color: var(--gray-muted);
 }

 .error {
   text-align: center;
   padding: 40px;
   color: var(--red-main);
 }


 
 /* ç§»åŠ¨ç«¯å…¨å±æ»šåŠ¨ä¼˜åŒ– */
 @media (max-width: 768px) {
   .ghost-container {
     padding: 15px;
     padding-top: 60px;
     /* ç¡®ä¿ç§»åŠ¨ç«¯å…¨å±æ»šåŠ¨ */
     width: 100% !important;
     height: 100% !important;
   }

   .header-title {
     font-size: 32px;
   }

   .header-subtitle {
     font-size: 16px;
   }

   .works-grid {
     grid-template-columns: 1fr;
     gap: 30px;
     row-gap: 30px;
     column-gap: 30px;
     padding: 15px 0;
   }

   .work-card {
     padding: 20px;
   }

   .work-title {
     font-size: 24px;
   }



   /* ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ– */
   .work-card {
     -webkit-touch-callout: none;
     -webkit-user-select: none;
     user-select: none;
   }
   
   /* ç§»åŠ¨ç«¯å…¨å±æ»šåŠ¨ä¼˜åŒ– */
   html, body {
     overflow: hidden !important;
     position: fixed;
     width: 100% !important;
     height: 100% !important;
   }
 }

    /* æ»šåŠ¨æ¡æ ·å¼ - å…¨å±æ»šåŠ¨æ—¶éšè— */
    .ghost-container::-webkit-scrollbar {
      display: none;
    }

    .ghost-container {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    /* åº•éƒ¨é®ç½©æ ·å¼ */
    .bottom-mask {
      position: absolute;
      left: 0; 
      bottom: 0;
      width: 100%;
      height: 92px;  /* å¯è¦†ç›–footeré«˜åº¦+é˜´å½± */
      background: #19171b;  /* ä½¿ç”¨ä¸é¡µé¢èƒŒæ™¯ä¸€è‡´çš„é¢œè‰² */
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
      z-index: 3;
      pointer-events: none;
    }

    /* ç¡®ä¿åº•éƒ¨å¯¼èˆªæ åœ¨é®ç½©ä¹‹ä¸Š */
    #footer-placeholder {
      z-index: 10;
    }
  </style>
</head>
<body>
  <div class="ghost-container">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="header-section">
      <h1 class="header-title">Ghost å…¬å¼€ç¯‡ç›®</h1>
      <p class="header-subtitle">KÃ–NIGINç³»åˆ—ä½œå“é›†</p>
    </div>

    <!-- ä½œå“åˆ—è¡¨å®¹å™¨ -->
    <div id="works-container">
      <div class="loading">æ­£åœ¨åŠ è½½ä½œå“ä¿¡æ¯...</div>
    </div>
  </div>

  <!-- åº•éƒ¨é®ç½© -->
  <div class="bottom-mask"></div>

  <!-- åº•éƒ¨å¯¼èˆªæ  -->
  <div id="footer-placeholder"></div>



  <script>
    // ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ–ç±»
    class GhostTouchOptimization {
      constructor() {
        this.touchStartY = 0;
        this.touchStartTime = 0;
        this.isScrolling = false;
        this.init();
      }

      init() {
        this.addTouchFeedback();
        this.addSwipeSupport();
        this.optimizeScroll();
      }

      // æ·»åŠ è§¦æ‘¸åé¦ˆ
      addTouchFeedback() {
        const interactiveElements = document.querySelectorAll('.work-card, .read-button');
        
        interactiveElements.forEach(element => {
          element.addEventListener('touchstart', (e) => {
            element.classList.add('touch-active');
            this.touchStartY = e.touches[0].clientY;
            this.touchStartTime = Date.now();
            // ä¸é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œè®©æ»‘åŠ¨æ£€æµ‹èƒ½æ­£å¸¸å·¥ä½œ
          }, { passive: true });

          element.addEventListener('touchend', (e) => {
            element.classList.remove('touch-active');
            const touchEndTime = Date.now();
            const touchDuration = touchEndTime - this.touchStartTime;
            
            // å¦‚æœè§¦æ‘¸æ—¶é—´å¾ˆçŸ­ï¼Œå¯èƒ½æ˜¯ç‚¹å‡»
            if (touchDuration < 200) {
              this.handleTouchClick(element, e);
            }
            // ä¸é˜»æ­¢äº‹ä»¶å†’æ³¡
          }, { passive: true });

          element.addEventListener('touchcancel', (e) => {
            element.classList.remove('touch-active');
          }, { passive: true });
        });
      }

      // å¤„ç†è§¦æ‘¸ç‚¹å‡»
      handleTouchClick(element, event) {
        if (element.classList.contains('work-card')) {
          const link = element.querySelector('.read-button')?.href;
          if (link) {
            window.location.href = link;
          }
        }
      }

      // æ·»åŠ æ»‘åŠ¨æ”¯æŒ
      addSwipeSupport() {
        const container = document.querySelector('.ghost-container');
        const body = document.body;
        let startX = 0;
        let startY = 0;
        let startTime = 0;
        let isHorizontalSwipe = false;

        // ä¸ºæ•´ä¸ªé¡µé¢æ·»åŠ è§¦æ‘¸äº‹ä»¶
        body.addEventListener('touchstart', (e) => {
          startX = e.touches[0].clientX;
          startY = e.touches[0].clientY;
          startTime = Date.now();
          this.isScrolling = false;
          isHorizontalSwipe = false;
        }, { passive: true });

        body.addEventListener('touchmove', (e) => {
          if (!this.isScrolling) {
            const deltaY = Math.abs(e.touches[0].clientY - startY);
            const deltaX = Math.abs(e.touches[0].clientX - startX);
            
            // åˆ¤æ–­æ˜¯æ°´å¹³æ»‘åŠ¨è¿˜æ˜¯å‚ç›´æ»‘åŠ¨
            if (deltaX > deltaY && deltaX > 20) {
              isHorizontalSwipe = true;
            } else if (deltaY > 10) {
              this.isScrolling = true;
            }
          }
        }, { passive: true });

        body.addEventListener('touchend', (e) => {
          const endX = e.changedTouches[0].clientX;
          const endY = e.changedTouches[0].clientY;
          const deltaX = endX - startX;
          const deltaY = endY - startY;
          const deltaTime = Date.now() - startTime;
          
          // å³æ»‘æ£€æµ‹ï¼šä»å·¦å‘å³æ»‘åŠ¨ï¼Œè·ç¦»å¤§äº40pxï¼Œæ—¶é—´å°äº500ms
          if (isHorizontalSwipe && deltaTime < 500 && deltaX > 40) {
            console.log('å³æ»‘æ£€æµ‹æˆåŠŸ:', { deltaX, deltaTime });
            this.handleRightSwipe();
            return;
          }
          
          // å‚ç›´æ»‘åŠ¨æ£€æµ‹
          if (!this.isScrolling && deltaTime < 300 && Math.abs(deltaY) > 50) {
            this.handleSwipe(deltaY);
          }
        }, { passive: true });
      }

      // å¤„ç†æ»‘åŠ¨
      handleSwipe(deltaY) {
        const container = document.querySelector('.ghost-container');
        const scrollAmount = deltaY > 0 ? -300 : 300; // å‘ä¸Šæ»‘åŠ¨å‘ä¸‹æ»šåŠ¨ï¼Œå‘ä¸‹æ»‘åŠ¨å‘ä¸Šæ»šåŠ¨
        
        container.scrollBy({
          top: scrollAmount,
          behavior: 'smooth'
        });
      }

      // å¤„ç†å³æ»‘è¿”å›
      handleRightSwipe() {
        console.log('å³æ»‘è¿”å›è§¦å‘');
        // ç›´æ¥è¿”å›ï¼Œæ— éœ€æç¤º
        window.location.href = 'public.html';
      }

      // æ˜¾ç¤ºæ»‘åŠ¨æç¤º
      showSwipeHint() {
        // åˆ›å»ºæç¤ºå…ƒç´ 
        const hint = document.createElement('div');
        hint.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: rgba(0, 0, 0, 0.8);
          color: var(--gold-light);
          padding: 15px 25px;
          border-radius: 5px;
          font-size: 16px;
          z-index: 10000;
          pointer-events: none;
          opacity: 0;
          transition: opacity 0.3s ease;
        `;
        hint.textContent = 'â† è¿”å›é…’å•';
        document.body.appendChild(hint);

        // æ˜¾ç¤ºæç¤º
        setTimeout(() => {
          hint.style.opacity = '1';
        }, 10);

        // éšè—æç¤º
        setTimeout(() => {
          hint.style.opacity = '0';
          setTimeout(() => {
            document.body.removeChild(hint);
          }, 300);
        }, 1000);
      }



      // ä¼˜åŒ–æ»šåŠ¨
      optimizeScroll() {
        const container = document.querySelector('.ghost-container');
        
        // å¯ç”¨å¹³æ»‘æ»šåŠ¨
        container.style.scrollBehavior = 'smooth';
        
        // è§¦æ‘¸æ»šåŠ¨ä¼˜åŒ–
        container.style.webkitOverflowScrolling = 'touch';
        container.style.overflowScrolling = 'touch';
        
        // ç¡®ä¿å…¨å±æ»šåŠ¨
        container.style.width = '100%';
        container.style.height = '100%';
        
        // é˜²æ­¢é¡µé¢æ•´ä½“æ»šåŠ¨
        document.body.style.overflow = 'hidden';
        document.documentElement.style.overflow = 'hidden';
      }
    }

    // åŠ è½½ä½œå“æ•°æ®
    async function loadWorks() {
      try {
        const response = await fetch('../../json/ghost.json');
        const works = await response.json();
        renderWorks(works);
      } catch (error) {
        console.error('Error loading works:', error);
        document.getElementById('works-container').innerHTML = 
          '<div class="error">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</div>';
      }
    }

    // æ¸²æŸ“ä½œå“åˆ—è¡¨
    function renderWorks(works) {
      const container = document.getElementById('works-container');
      
      if (!works || works.length === 0) {
        container.innerHTML = '<div class="error">æš‚æ— ä½œå“</div>';
        return;
      }

      const worksHTML = works.map(work => `
        <div class="work-card" onclick="openWork('${work.link}')">
          <div class="work-header">
            <h2 class="work-title">${work.title}</h2>
            <div class="work-author">by ${work.author}</div>
          </div>

          <div class="work-meta">
            <span class="rating-badge rating-${work.rating.toLowerCase()}">${work.rating}</span>
            <span class="status-badge status-${work.status.toLowerCase()}">${getStatusText(work.status)}</span>
          </div>

          <div class="work-summary">"${work.summary}"</div>
          
          <div class="work-description">${work.description}</div>

          ${work.warnings && work.warnings.length > 0 ? `
            <div class="tags-section">
              <div class="section-title">âš ï¸ é¢„è­¦æ ‡ç­¾</div>
              <div class="tags-list">
                ${work.warnings.map(warning => 
                  `<span class="tag warning-tag">${warning}</span>`
                ).join('')}
              </div>
            </div>
          ` : ''}

          ${work.tags && work.tags.length > 0 ? `
            <div class="tags-section">
              <div class="section-title">ğŸ·ï¸ æ ‡ç­¾</div>
              <div class="tags-list">
                ${work.tags.slice(0, 8).map(tag => 
                  `<span class="tag">${tag}</span>`
                ).join('')}
                ${work.tags.length > 8 ? `<span class="tag">+${work.tags.length - 8} more</span>` : ''}
              </div>
            </div>
          ` : ''}

          <div class="work-footer">
            <div class="work-meta-info">
              ${work.originalDate} â€¢ ${work.copyright} â€¢ ${work.length}
            </div>
            <a href="${work.link}" class="read-button" onclick="event.stopPropagation()">
              é˜…è¯»å…¨æ–‡
            </a>
          </div>
        </div>
      `).join('');

      container.innerHTML = worksHTML;
    }

    // è·å–çŠ¶æ€æ–‡æœ¬
    function getStatusText(status) {
      const statusMap = {
        'Completed': 'å·²å®Œæˆ',
        'In Progress': 'è¿›è¡Œä¸­',
        'Planned': 'è®¡åˆ’ä¸­'
      };
      return statusMap[status] || status;
    }

    // æ‰“å¼€ä½œå“
    function openWork(link) {
      if (link) {
        window.location.href = link;
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      // è®¾ç½®å…¨å±æ»šåŠ¨
      document.body.style.overflow = 'hidden';
      document.documentElement.style.overflow = 'hidden';
      
      loadWorks();
      
      // åˆå§‹åŒ–è§¦æ‘¸ä¼˜åŒ–
      new GhostTouchOptimization();
    });
  </script>

  <!-- åŠ è½½åº•éƒ¨å¯¼èˆªæ  -->
  <script src="../../js/footer.js"></script>
</body>
</html>
