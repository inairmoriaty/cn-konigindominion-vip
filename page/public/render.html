<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KÃ–NIGIN - æ¸²æŸ“å›¾é›†</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }

    html, body {
      width: 100vw;
      height: 100vh;
      background: #191919;
      font-family: 'Arial', sans-serif;
      overflow-x: hidden;
    }

    .app-frame {
      width: 100vw;
      height: 100vh;
      position: relative;
      background: #191919;
      padding-top: var(--safe-top);
      padding-bottom: var(--safe-bottom);
      overflow-y: auto;
      overflow-x: hidden;
    }

    .main-bg {
      position: fixed;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: url('../../img/home_bg.png') center center/cover no-repeat;
      z-index: 1;
      opacity: 0.3;
    }

    .gallery-container {
      position: relative;
      z-index: 2;
      padding: 20px 10px;
      padding-top: 80px;
      padding-bottom: calc(clamp(56px, 9vh, 72px) + env(safe-area-inset-bottom, 0px) + 20px);
      min-height: 100vh;
      box-sizing: border-box;
    }

    .gallery-title {
      text-align: center;
      color: #ffffff;
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 30px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    .gallery-grid {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      max-width: 100vw;
      margin: 0 auto;
      padding: 0 20px;
    }

    .gallery-item {
      position: relative;
      width: 100%;
      max-width: 400px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .gallery-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .gallery-item img {
      width: 100%;
      aspect-ratio: 1;
      object-fit: cover;
      display: block;
      transition: opacity 0.3s ease;
    }

    .gallery-item:hover img {
      opacity: 0.9;
    }

    .gallery-item-caption {
      padding: 12px 16px;
      font-size: 14px;
      line-height: 1.5;
      color: #262626;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      word-wrap: break-word;
      word-break: break-word;
      hyphens: auto;
      white-space: normal;
    }

    .gallery-item-caption strong {
      font-size: 16px;
      font-weight: 700;
      color: #000000;
      display: block;
      margin-bottom: 4px;
    }

    .loading-placeholder {
      width: 100%;
      aspect-ratio: 1;
      background: linear-gradient(45deg, #f5f5f5, #e8e8e8);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #999;
      font-size: 14px;
      border-radius: 0;
    }

    /* Lightbox æ ·å¼ */
    .lightbox {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.95);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      backdrop-filter: blur(10px);
    }

    .lightbox.active {
      display: flex;
    }

    .lightbox-content {
      position: relative;
      max-width: 90vw;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .lightbox-image {
      max-width: 100%;
      max-height: 80vh;
      object-fit: contain;
      border-radius: 8px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }

    .lightbox-close {
      position: absolute;
      top: -50px;
      right: 0;
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      font-size: 24px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.3s ease;
    }

    .lightbox-close:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .lightbox-info {
      margin-top: 15px;
      color: white;
      text-align: center;
      font-size: 16px;
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .gallery-grid {
        gap: 16px;
        padding: 0 16px;
      }

      .gallery-item {
        max-width: 100%;
      }

      .gallery-container {
        padding: 15px 0;
        padding-top: 60px;
      }

      .gallery-title {
        font-size: 24px;
        margin-bottom: 20px;
      }

      .gallery-item-caption {
        padding: 10px 12px;
        font-size: 13px;
      }

      .gallery-item-caption strong {
        font-size: 15px;
        font-weight: 700;
        color: #000000;
        display: block;
        margin-bottom: 3px;
      }

      .lightbox-content {
        max-width: 95vw;
        max-height: 95vh;
      }

      .lightbox-image {
        max-height: 75vh;
      }
    }

    @media (max-width: 480px) {
      .gallery-grid {
        gap: 12px;
        padding: 0 12px;
      }

      .gallery-item {
        max-width: 100%;
      }

      .gallery-title {
        font-size: 20px;
      }

      .gallery-item-caption {
        padding: 8px 10px;
        font-size: 12px;
      }

      .gallery-item-caption strong {
        font-size: 14px;
        font-weight: 700;
        color: #000000;
        display: block;
        margin-bottom: 2px;
      }
    }

    /* åŠ è½½åŠ¨ç”» */
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid #333;
      border-top: 3px solid #fff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* ç©ºçŠ¶æ€ */
    .empty-state {
      text-align: center;
      color: #666;
      padding: 60px 20px;
    }

    .empty-state h3 {
      font-size: 24px;
      margin-bottom: 15px;
      color: #888;
    }

    .empty-state p {
      font-size: 16px;
      line-height: 1.5;
    }

    /* Footer æ ·å¼ */
    .bottom-nav {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(env(safe-area-inset-bottom, 0px) + 8px);
      
      width: min(92vw, 430px);
      height: clamp(56px, 9vh, 72px);
      padding-bottom: env(safe-area-inset-bottom, 0px);
      
      background: #191919cc;
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 -8px 24px rgba(0,0,0,.25);
      
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }

    .bottom-nav nav {
      width: 100%;
      max-width: 380px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: clamp(8px, 3vw, 16px);
    }

    .bottom-nav .nav-btn {
      width: clamp(48px, 12vw, 56px);
      height: clamp(48px, 12vw, 56px);
      border-radius: 16px;
      background: #232323;
      display: flex; 
      justify-content: center; 
      align-items: center;
      transition: background .2s, transform .15s;
      text-decoration: none;
    }

    .bottom-nav .nav-btn:active,
    .bottom-nav .nav-btn.selected {
      background: #343434;
      transform: translateY(-2px);
    }

    .bottom-nav .nav-btn img {
      width: clamp(24px, 7vw, 32px);
      height: clamp(24px, 7vw, 32px);
      object-fit: contain;
      display: block;
    }

    /* ç¡®ä¿é¡µé¢å†…å®¹ä¸è¢«footeré®æŒ¡ */
    body {
      padding-bottom: calc(clamp(56px, 9vh, 72px) + env(safe-area-inset-bottom, 0px) + 20px);
    }

    /* æ»‘åŠ¨è¿”å›æŒ‡ç¤ºå™¨æ ·å¼ */
    #swipe-back-indicator {
      position: fixed;
      top: 50%;
      left: 20px;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px 15px;
      border-radius: 20px;
      font-size: 14px;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* é¡µé¢æ»‘åŠ¨è¿”å›åŠ¨ç”» */
    .swipe-back-transition {
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* å·¦è¾¹ç¼˜æ»‘åŠ¨æç¤º */
    .swipe-hint {
      position: fixed;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 4px;
      height: 60px;
      background: linear-gradient(to right, rgba(255, 255, 255, 0.3), transparent);
      border-radius: 0 2px 2px 0;
      z-index: 100;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .swipe-hint.show {
      opacity: 1;
    }

    @media (max-width: 768px) {
      #swipe-back-indicator {
        left: 15px;
        padding: 8px 12px;
        font-size: 12px;
      }
    }

    /* åº•éƒ¨é®ç½© */
    .bottom-mask {
      position: absolute;
      left: 0; 
      bottom: 0;
      width: 100%;
      height: 92px;  /* å¯è¦†ç›–footeré«˜åº¦+é˜´å½± */
      background: #191919;
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
      z-index: 3;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div class="app-frame">
    <div class="main-bg"></div>
    
    <div class="gallery-container">
      <h1 class="gallery-title">æ¸²æŸ“å›¾é›†</h1>
      
      <div class="gallery-grid" id="galleryGrid">
        <div class="loading-spinner"></div>
      </div>
    </div>

    <div class="bottom-mask"></div>
  </div>

  <!-- Footer å ä½ç¬¦ -->
  <div id="footer-placeholder"></div>

  <!-- å·¦è¾¹ç¼˜æ»‘åŠ¨æç¤º -->
  <div class="swipe-hint" id="swipeHint"></div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox">
    <div class="lightbox-content">
      <button class="lightbox-close" id="lightboxClose">&times;</button>
      <img class="lightbox-image" id="lightboxImage" alt="">
      <div class="lightbox-info" id="lightboxInfo"></div>
    </div>
  </div>

  <script>
    class RenderGallery {
      constructor() {
        this.galleryGrid = document.getElementById('galleryGrid');
        this.lightbox = document.getElementById('lightbox');
        this.lightboxImage = document.getElementById('lightboxImage');
        this.lightboxInfo = document.getElementById('lightboxInfo');
        this.lightboxClose = document.getElementById('lightboxClose');
        
        this.images = [];
        this.init();
      }

      async init() {
        await this.loadImages();
        this.renderGallery();
        this.bindEvents();
      }

      // æ–°å¢ï¼šæ‹‰å–æ¸…å•
      async fetchManifest() {
        const url = `../../json/render.json?ts=${Date.now()}`; // é˜²ç¼“å­˜
        const res = await fetch(url, { cache: 'no-store' });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        return await res.json();
      }

      // æ›¿æ¢ï¼šä» JSON æ˜ å°„åˆ°å†…éƒ¨ this.images
      async loadImages() {
        try {
          const manifest = await this.fetchManifest();
          this.images = (manifest.items || []).map(it => ({
            src: it.src,                         // å¤§å›¾ï¼ˆLightboxï¼‰
            thumb: it.thumb || it.src,           // å°å›¾ï¼ˆç½‘æ ¼ï¼‰
            alt: it.title || this.generateAltText(it.id || it.src),
            title: it.title || "",
            caption: it.caption || "",
            author: it.author || "",
            tags: it.tags || [],
            created_at: it.created_at || "",
            width: it.width,
            height: it.height,
            nsfw: !!it.nsfw
          }));
        } catch (err) {
          console.error('åŠ è½½æ¸…å•å¤±è´¥:', err);
          this.showEmptyState();
        }
      }

      generateAltText(filename) {
        // ä»æ–‡ä»¶åç”Ÿæˆ alt æ–‡æœ¬
        const nameWithoutExt = filename.replace(/\.[^/.]+$/, "");
        return nameWithoutExt.replace(/[-_]/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
      }

      renderGallery() {
        if (this.images.length === 0) {
          this.showEmptyState();
          return;
        }

        this.galleryGrid.innerHTML = '';
        
        this.images.forEach((image, index) => {
          const galleryItem = this.createGalleryItem(image, index);
          this.galleryGrid.appendChild(galleryItem);
        });
      }

      createGalleryItem(image, index) {
        const item = document.createElement('div');
        item.className = 'gallery-item';
        item.dataset.index = index;
        
        const img = document.createElement('img');
        img.src = image.thumb;                // ğŸ‘ˆ åˆ—è¡¨ç”¨å°å›¾
        img.alt = image.alt;
        img.loading = 'lazy';
        
        // æ·»åŠ åŠ è½½çŠ¶æ€
        const placeholder = document.createElement('div');
        placeholder.className = 'loading-placeholder';
        placeholder.textContent = 'åŠ è½½ä¸­...';
        
        // æ·»åŠ å›¾ç‰‡è¯´æ˜æ–‡å­—åŒºåŸŸ
        const caption = document.createElement('div');
        caption.className = 'gallery-item-caption';
        
        // åˆ›å»ºæ ‡é¢˜å’Œé…æ–‡å†…å®¹ï¼šé»‘ä½“åŠ ç²—çš„titleâ€”â€”ï¼ˆåˆ†è¡Œï¼‰â€”â€”caption
        const title = image.title || image.alt || 'æ¸²æŸ“ä½œå“';
        const captionText = image.caption || '';
        
        if (captionText) {
          // å°†æ¢è¡Œç¬¦è½¬æ¢ä¸º <br> æ ‡ç­¾ï¼Œä¿æŒåˆ†æ®µæ˜¾ç¤º
          const formattedCaption = captionText.replace(/\n/g, '<br>');
          caption.innerHTML = `<strong>${title}</strong><br>${formattedCaption}`;
        } else {
          caption.innerHTML = `<strong>${title}</strong>`;
        }
        
        item.appendChild(placeholder);
        item.appendChild(img);
        item.appendChild(caption);
        
        // å›¾ç‰‡åŠ è½½å®Œæˆåéšè—å ä½ç¬¦
        img.onload = () => {
          placeholder.style.display = 'none';
        };
        
        img.onerror = () => {
          placeholder.textContent = 'åŠ è½½å¤±è´¥';
          placeholder.style.color = '#ff6b6b';
        };
        
        return item;
      }

      showEmptyState() {
        this.galleryGrid.innerHTML = `
          <div class="empty-state">
            <h3>æš‚æ— å›¾ç‰‡</h3>
            <p>æ¸²æŸ“å›¾é›†ä¸­æš‚æ—¶æ²¡æœ‰å›¾ç‰‡ï¼Œè¯·ç¨åå†æ¥æŸ¥çœ‹ã€‚</p>
          </div>
        `;
      }

      bindEvents() {
        // ç‚¹å‡»å›¾ç‰‡æ‰“å¼€ lightbox
        this.galleryGrid.addEventListener('click', (e) => {
          const galleryItem = e.target.closest('.gallery-item');
          if (galleryItem) {
            const index = parseInt(galleryItem.dataset.index);
            this.openLightbox(index);
          }
        });

        // å…³é—­ lightbox
        this.lightboxClose.addEventListener('click', () => {
          this.closeLightbox();
        });

        // ç‚¹å‡»èƒŒæ™¯å…³é—­ lightbox
        this.lightbox.addEventListener('click', (e) => {
          if (e.target === this.lightbox) {
            this.closeLightbox();
          }
        });

        // ESC é”®å…³é—­ lightbox
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && this.lightbox.classList.contains('active')) {
            this.closeLightbox();
          }
        });

        // é”®ç›˜å¯¼èˆª
        document.addEventListener('keydown', (e) => {
          if (!this.lightbox.classList.contains('active')) return;
          
          if (e.key === 'ArrowLeft') {
            this.previousImage();
          } else if (e.key === 'ArrowRight') {
            this.nextImage();
          }
        });

        // ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ–
        this.addMobileOptimizations();
      }

      addMobileOptimizations() {
        // ä¸ºå›¾é›†é¡¹ç›®æ·»åŠ è§¦æ‘¸åé¦ˆ
        this.galleryGrid.addEventListener('touchstart', (e) => {
          const galleryItem = e.target.closest('.gallery-item');
          if (galleryItem) {
            galleryItem.style.transform = 'scale(0.95)';
            galleryItem.style.transition = 'transform 0.1s ease';
          }
        }, { passive: true });

        this.galleryGrid.addEventListener('touchend', (e) => {
          const galleryItem = e.target.closest('.gallery-item');
          if (galleryItem) {
            galleryItem.style.transform = '';
            galleryItem.style.transition = 'transform 0.3s ease';
          }
        }, { passive: true });

        this.galleryGrid.addEventListener('touchcancel', (e) => {
          const galleryItem = e.target.closest('.gallery-item');
          if (galleryItem) {
            galleryItem.style.transform = '';
            galleryItem.style.transition = 'transform 0.3s ease';
          }
        }, { passive: true });

        // ä¸º lightbox æ·»åŠ æ»‘åŠ¨åˆ‡æ¢åŠŸèƒ½
        if (window.MobileOptimization && window.mobileOptimization) {
          window.mobileOptimization.optimizeSwipeEvents(this.lightbox, {
            onSwipeLeft: () => this.nextImage(),
            onSwipeRight: () => this.previousImage(),
            onSwipeUp: () => this.closeLightbox(),
            minSwipeDistance: 50,
            maxSwipeTime: 300
          });
        }

        // æ·»åŠ é¡µé¢çº§åˆ«çš„å·¦æ»‘è¿”å›åŠŸèƒ½
        this.addSwipeBackNavigation();

        // é˜²æ­¢åŒå‡»ç¼©æ”¾
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
          const now = (new Date()).getTime();
          if (now - lastTouchEnd <= 300) {
            e.preventDefault();
          }
          lastTouchEnd = now;
        }, false);

        // ä¼˜åŒ–æ»šåŠ¨æ€§èƒ½
        this.galleryGrid.style.webkitOverflowScrolling = 'touch';
        this.galleryGrid.style.overflowScrolling = 'touch';
      }

      addSwipeBackNavigation() {
        let startX = 0;
        let startY = 0;
        let startTime = 0;
        let isSwipeBackActive = false;
        let swipeHintTimeout = null;

        // æ˜¾ç¤ºæ»‘åŠ¨æç¤º
        this.showSwipeHint();

        // é¡µé¢çº§åˆ«çš„è§¦æ‘¸äº‹ä»¶ç›‘å¬
        document.addEventListener('touchstart', (e) => {
          // å¦‚æœ lightbox æ‰“å¼€ï¼Œä¸å¤„ç†é¡µé¢çº§åˆ«çš„æ»‘åŠ¨
          if (this.lightbox.classList.contains('active')) {
            return;
          }

          startX = e.touches[0].clientX;
          startY = e.touches[0].clientY;
          startTime = Date.now();
          isSwipeBackActive = false;

          // éšè—æ»‘åŠ¨æç¤º
          this.hideSwipeHint();
        }, { passive: true });

        document.addEventListener('touchmove', (e) => {
          if (this.lightbox.classList.contains('active')) {
            return;
          }

          const currentX = e.touches[0].clientX;
          const currentY = e.touches[0].clientY;
          const deltaX = currentX - startX;
          const deltaY = currentY - startY;

          // æ£€æµ‹æ˜¯å¦ä¸ºæ°´å¹³å³æ»‘ï¼ˆä»å·¦è¾¹ç¼˜å¼€å§‹ï¼Œä¸public.htmlçš„æ»‘åŠ¨æ£€æµ‹é€»è¾‘ä¸€è‡´ï¼‰
          if (startX < 50 && deltaX > 20 && Math.abs(deltaY) < 100) {
            isSwipeBackActive = true;
            // æ·»åŠ è§†è§‰åé¦ˆ
            this.showSwipeBackIndicator(deltaX);
          }
        }, { passive: true });

        document.addEventListener('touchend', (e) => {
          if (this.lightbox.classList.contains('active')) {
            return;
          }

          const endX = e.changedTouches[0].clientX;
          const endY = e.changedTouches[0].clientY;
          const deltaX = endX - startX;
          const deltaY = endY - startY;
          const deltaTime = Date.now() - startTime;

          // éšè—æ»‘åŠ¨æŒ‡ç¤ºå™¨
          this.hideSwipeBackIndicator();

          // æ£€æŸ¥æ˜¯å¦æ»¡è¶³å³æ»‘è¿”å›æ¡ä»¶ï¼ˆä¸public.htmlçš„æ»‘åŠ¨æ£€æµ‹é€»è¾‘ä¸€è‡´ï¼‰
          if (isSwipeBackActive && 
              deltaX > 50 && 
              Math.abs(deltaY) < 100 && 
              deltaTime < 500) {
            this.navigateBack();
          } else {
            // å¦‚æœæ²¡æœ‰è§¦å‘è¿”å›ï¼Œå»¶è¿Ÿæ˜¾ç¤ºæ»‘åŠ¨æç¤º
            swipeHintTimeout = this.scheduleSwipeHint(swipeHintTimeout);
          }
        }, { passive: true });

        document.addEventListener('touchcancel', (e) => {
          this.hideSwipeBackIndicator();
          swipeHintTimeout = this.scheduleSwipeHint(swipeHintTimeout);
        }, { passive: true });
      }

      showSwipeHint() {
        const hint = document.getElementById('swipeHint');
        if (hint) {
          hint.classList.add('show');
        }
      }

      hideSwipeHint() {
        const hint = document.getElementById('swipeHint');
        if (hint) {
          hint.classList.remove('show');
        }
      }

      scheduleSwipeHint(timeoutRef) {
        // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
        if (timeoutRef) {
          clearTimeout(timeoutRef);
        }
        
        // å»¶è¿Ÿæ˜¾ç¤ºæ»‘åŠ¨æç¤º
        return setTimeout(() => {
          this.showSwipeHint();
        }, 2000);
      }

      showSwipeBackIndicator(deltaX) {
        // åˆ›å»ºæˆ–æ›´æ–°æ»‘åŠ¨æŒ‡ç¤ºå™¨
        let indicator = document.getElementById('swipe-back-indicator');
        if (!indicator) {
          indicator = document.createElement('div');
          indicator.id = 'swipe-back-indicator';
          indicator.innerHTML = 'â† è¿”å›';
          indicator.style.cssText = `
            position: fixed;
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.2s ease;
            pointer-events: none;
          `;
          document.body.appendChild(indicator);
        }

        // æ ¹æ®æ»‘åŠ¨è·ç¦»è°ƒæ•´é€æ˜åº¦
        const opacity = Math.min(deltaX / 100, 1);
        indicator.style.opacity = opacity;
      }

      hideSwipeBackIndicator() {
        const indicator = document.getElementById('swipe-back-indicator');
        if (indicator) {
          indicator.style.opacity = '0';
        }
      }

      navigateBack() {
        // æ·»åŠ è¿”å›åŠ¨ç”»
        document.body.style.transition = 'transform 0.3s ease';
        document.body.style.transform = 'translateX(100%)';
        
        // å»¶è¿Ÿè·³è½¬ï¼Œè®©åŠ¨ç”»å®Œæˆ
        setTimeout(() => {
          window.location.href = 'public.html';
        }, 300);
      }

      openLightbox(index) {
        if (index < 0 || index >= this.images.length) return;
        const image = this.images[index];
        this.currentIndex = index;

        this.lightboxImage.src = image.src; // ğŸ‘ˆ ç”¨å¤§å›¾
        this.lightboxImage.alt = image.alt;

        const infoParts = [image.title || image.alt];
        if (image.author) infoParts.push(`by ${image.author}`);
        if (image.created_at) infoParts.push(image.created_at);
        this.lightboxInfo.textContent = `${infoParts.filter(Boolean).join(' Â· ')} (${index+1}/${this.images.length})`;

        this.lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      closeLightbox() {
        this.lightbox.classList.remove('active');
        document.body.style.overflow = '';
      }

      previousImage() {
        if (this.currentIndex > 0) {
          this.openLightbox(this.currentIndex - 1);
        }
      }

      nextImage() {
        if (this.currentIndex < this.images.length - 1) {
          this.openLightbox(this.currentIndex + 1);
        }
      }
    }

    // åˆå§‹åŒ–å›¾é›†
    document.addEventListener('DOMContentLoaded', () => {
      new RenderGallery();
    });
  </script>

  <!-- å¼•å…¥ Footer å’Œç§»åŠ¨ç«¯ä¼˜åŒ–è„šæœ¬ -->
  <script src="../../js/footer.js"></script>
  <script src="../../js/mobile-optimization.js"></script>
</body>
</html>
